function [lny,sigma,tau,phi]=Parker2020(To,M,Rrup,Zhyp,Vs30,Z25,mechanism,region)

% Syntax : Parker2020 Z25 mechanism region                                  

st          = dbstack;
isadmisible = isIMadmisible(To,st(1).name,[0 10],[nan nan],[nan nan],[nan nan]);
if isadmisible==0
    lny   = nan(size(M));
    sigma = nan(size(M));
    tau   = nan(size(M));
    phi   = nan(size(M));
    return
end

Z25 = Z25*1000; %Z2.5 must be input in km

% mechanism flag and Magnitude breaking point
% switch mechanism
%     case 'interface'
%         IF = 1;
%         switch region
%             case 'global',               mc=7.9;  regID='All';
%             case 'alaska',               mc=8.6;  regID='AK';
%             case 'aleutian',             mc=8.0;  regID='AK';
%             case 'cascadia',             mc=7.7;  regID='CASC';
%             case 'central_america_n',    mc=7.4;  regID='CAM';
%             case 'central_america_s',    mc=7.4;  regID='CAM';
%             case 'japan_pac',            mc=8.5;  regID='JP';
%             case 'japan_phi',            mc=7.7;  regID='JP';
%             case 'south_america_n',      mc=8.5;  regID='SA';
%             case 'south_america_s',      mc=8.6;  regID='SA';
%             case 'taiwan',               mc=7.1;  regID='TW';
%         end
%     case 'intraslab'
%         IF = 0;
%         switch region
%             case 'global',               mc=7.60;  regID='All';
%             case 'alaska',               mc=7.20;  regID='AK';
%             case 'aleutian',             mc=7.98;  regID='ALE';
%             case 'cascadia',             mc=7.20;  regID='CASC';
%             case 'central_america_n',    mc=7.40;  regID='CAM';
%             case 'central_america_s',    mc=7.60;  regID='CAM';
%             case 'japan_pac',            mc=7.65;  regID='JP';
%             case 'japan_phi',            mc=7.55;  regID='JP';
%             case 'south_america_n',      mc=7.30;  regID='SANorth';
%             case 'south_america_s',      mc=7.25;  regID='SASouth';
%             case 'taiwan',               mc=7.70;  regID='TW';
%         end
% end

switch mechanism
    case 'interface'
        IF=1;
        switch region
            case 'global',               mc=7.8;   regID='All';
            case 'aleutian',             mc=8.0;   regID='AK';
            case 'alaska',               mc=8.0;   regID='AK';
            case 'cascadia',             mc=7.56;  regID='CASC';
            case 'central_america_s',    mc=7.5;   regID='CAM';
            case 'central_america_n',    mc=7.45;  regID='CAM';
            case 'japan_pac',            mc=8.31;  regID='JP';
            case 'japan_phi',            mc=7.28;  regID='JP';
            case 'south_america_n',      mc=8.45;  regID='SA';
            case 'south_america_s',      mc=8.45;  regID='SA';
            case 'taiwan',               mc=8.0;   regID='TW';
        end
    case 'intraslab'
        IF=0;
        switch region
            case 'global',               mc=7.6;   regID='All';
            case 'aleutian',             mc=7.98;  regID='AK';
            case 'alaska',               mc=7.2;   regID='ALE';
            case 'cascadia',             mc=7.2;   regID='CASC';
            case 'central_america_s',    mc=7.6;   regID='CAM';
            case 'central_america_n',    mc=7.4;   regID='CAM';
            case 'japan_pac',            mc=7.65;  regID='JP';
            case 'japan_phi',            mc=7.55;  regID='JP';
            case 'south_america_n',      mc=7.3;   regID='SANorth';
            case 'south_america_s',      mc=7.25;  regID='SASouth';
            case 'taiwan',               mc=7.7;   regID='TW';
        end
end

% computation of h
switch mechanism
    case 'interface'
        h = 10.^(-0.82+0.252*M);
    case 'intraslab'
        %h = 10.^(1.050*(M-mc)/(mc-4)+1.544);
        m  = (log10(35) - log10(3.12)) / (mc - 4);
        h = 10.^(m* (M - mc) + log10(35));
        h(M>mc)=35;
end


if To>=0
    To  = max(To,0.001);  % PGA is associated to To=0.01;
end
period  = [-1 0.001 0.01 0.02 0.025 0.03 0.04 0.05 0.075 0.1 0.15 0.2 0.25 0.3 0.4 0.5 0.75 1 1.5 2 2.5 3 4 5 7.5 10];

T_lo    = max(period(period<=To));
T_hi    = min(period(period>=To));
index   = find(abs((period - T_lo)) < 1e-6);    % Identify the period

% computes PGARock
PGAr = exp(gmpe(2,M,mc,Rrup,h,760,Zhyp,IF,regID,Z25,[]));

if T_lo==T_hi
    [lny,tau,phi] = gmpe(index  ,M,mc,Rrup,h,Vs30,Zhyp,IF,regID,Z25,PGAr);
else
    [lny_lo,tau_lo,phi_lo] = gmpe(index,  M,mc,Rrup,h,Vs30,Zhyp,IF,regID,Z25,PGAr);
    [lny_hi,tau_hi,phi_hi] = gmpe(index+1,M,mc,Rrup,h,Vs30,Zhyp,IF,regID,Z25,PGAr);
    x          = log([T_lo;T_hi]);
    Y_sa       = [lny_lo,lny_hi]';
    Y_sigma2   = [tau_lo,tau_hi]';
    Y_sigma1   = [phi_lo,phi_hi]';
    lny        = interp1(x,Y_sa,log(To))';
    phi        = interp1(x,Y_sigma2,log(To))';
    tau        = interp1(x,Y_sigma1,log(To))';
end

sigma = sqrt(tau.^2+phi.^2);

function[lny,tau,phi]=gmpe(index,M,mc,Rrup,h,VS30,Zhyp,IF,regID,Z25,PGAr)

C   = Parker2020coefficients(index,  IF);
FD  = 0;
FS  = 0;
Fnl = 0;

if IF
    c1 =C(7);
    b4 =C(8);
    c4 =C(16);
    c5 =C(17);
    c6 =C(18);
    V1 =C(19);
    V2 =C(20);
    Vref=C(21);
    f4 =C(30);
    f5 =C(31);
    %     dN =C(38);
    %     dS =C(39);
    
    tau                   =C(40);
    PhiTot_Phi1squared    =C(41);
    PhiTot_Phi2squared    =C(42);
    PhiTot_PhiVsquared    =C(43);
    %     PhiS2S_PhiS2S0squared =C(44);
    %     PhiS2S_a1             =C(45);
    %     PhiS2S_VM             =C(46);
    %     PhiSS_PhiSS1squared   =C(47);
    %     PhiSS_PhiSS2squared   =C(48);
    %     PhiSS_a2              =C(49);
    %     PhiSS_VM              =C(50);
    
    
    
    switch regID
        case 'All'
            c0=C(1);
            a0=C(9);
            s2=C(24);
            s1=s2;
        case 'AK'
            c0=C(2);
            a0=C(10);
            s2=C(25);
            s1=s2;
        case 'CASC'
            a0=C(11);
            s2=C(26);
            e1=C(35);
            e2=C(36);
            e3=C(37);
            s1=s2;
            
        case 'CAM'
            c0=C(3);
            a0=C(12);
            s2=C(24); % Global s2
            s1=s2;    % Global s1
            
        case 'JP'
            c0=C(4);
            a0=C(13);
            s1=C(22);
            s2=C(27);
            e1=C(32);
            e2=C(33);
            e3=C(34);
            
        case 'SA'
            c0=C(5);
            a0=C(14);
            s2=C(28);
            s1=s2;
        case 'TW'
            c0=C(6);
            a0=C(15);
            s1=C(23);
            s2=C(29);
    end
end

if ~IF
    c1=C(9);
    b4=C(10);
    c4=C(18);
    c5=C(19);
    c6=C(20);
    d=C(21);
    m=C(22);
    %     db=C(23);
    V1=C(24);
    V2=C(25);
    Vref=C(26);
    f4=C(35);
    f5=C(36);
    %     dN=C(43);
    %     dS=C(44);
    
    tau                   =C(38);
    PhiTot_Phi1squared    =C(39);
    PhiTot_Phi2squared    =C(40);
    PhiTot_PhiVsquared    =C(41);
    %     PhiS2S_PhiS2S0squared =C(42);
    %     PhiS2S_a1             =C(43);
    %     PhiS2S_VM             =C(44);
    %     PhiSS_PhiSS1squared   =C(45);
    %     PhiSS_PhiSS2squared   =C(46);
    %     PhiSS_a2              =C(47);
    %     PhiSS_VM              =C(48);
    
    switch regID
        case 'All'
            c0=C(1);
            a0=C(11);
            s2=C(29);
            s1=s2;
            
        case 'AK'
            c0=C(2);
            a0=C(12);
            s2=C(30);
            s1=s2;
            
        case 'ALE'
            c0=C(3);
            a0=C(12);
            s2=C(30);
            s1=s2;
            
        case 'CASC'
            a0=C(13);
            s2=C(31);
            e1=C(40);
            e2=C(41);
            e3=C(42);
            s1=s2;
            
        case 'CAM'
            c0=C(4);
            a0=C(14);
            s2=C(29); % global S2
            s1=s2;    % global S1
            
        case 'JP'
            c0=C(5);
            a0=C(15);
            s1=C(27);
            s2=C(32);
            e1=C(37);
            e2=C(38);
            e3=C(39);
            
        case 'SANorth'
            c0=C(6);
            a0=C(16);
            s2=C(33);
            s1=s2;
            
        case 'SASouth'
            c0=C(7);
            a0=C(16);
            s2=C(33);
            s1=s2;
            
        case 'TW'
            c0=C(8);
            a0=C(17);
            s1=C(28);
            s2=C(34);
    end
    
end

if ~isempty(PGAr)
    1;
end

%% MEDIAN MODEL
% Path Term
R  = sqrt(Rrup.^2+h.^2);
Rref = sqrt(1 + h.^ 2);
FP = c1*log(R)+b4*M.*log(R./Rref)+a0*R;

% Magnitude Scaling Term

FM = c4*(M-mc)+c5*(M-mc).^2;
FM(M>mc)=c6*(M(M>mc)-mc);

% Depth Scaling Term
if ~IF
    db1 = 20;
    db2 = 67;
    FD  = m*(Zhyp-db2)+d;
    FD(Zhyp<db1)=m*(db1-db2)+d;
    FD(Zhyp>db2)=d;
end

% Ergodic Site Term
period  = [-1 0.001 0.01 0.02 0.025 0.03 0.04 0.05 0.075 0.1 0.15 0.2 0.25 0.3 0.4 0.5 0.75 1 1.5 2 2.5 3 4 5 7.5 10];
if ~isempty(PGAr)
    if VS30<=V1
        Flin = s1*log(VS30/V1)+s2*log(V1/Vref);
    elseif and(V1<VS30,VS30<=V2)
        Flin = s2*log(VS30/Vref);
    elseif VS30>V2
        Flin = s2*log(V2/Vref);
    end
    
    
    if period(index)< 3
        f1  = 0;
        f3  = 0.05;
        Vref_Fnl = 900;
        Vb       = 200;
        f2  = f4*(exp(f5*(min(VS30,Vref_Fnl)-Vb))-exp(f5*(Vref_Fnl-Vb)));
        Fnl = f1+f2*log((PGAr+f3)/f3);
    end
    
    
    Fb = 0;
    if strcmp(regID,'CASC') && e3~=0
        th0      =  3.94;
        th1      = -0.42;
        numu     = 200;
        nusigma  = 0.2;
        dnm      = (log10(VS30)-log10(numu))/(nusigma*sqrt(2));
        lnmuZ25    = log(10)*th1*(1+erf(dnm))+log(10)*th0;
        deltaZ25 = log(Z25)-lnmuZ25; %4.12
        if deltaZ25<=e1/e3
            Fb = e1;
        elseif and(e1/e3<deltaZ25,deltaZ25<e2/e3)
            Fb       = e3*deltaZ25;
        else
            Fb = e2;
        end
    end
    
    if strcmp(regID,'JP') && e3~=0
        th0      = 3.05;
        th1      = -0.8;
        numu     = 500;
        nusigma  = 0.33;
        dnm      = (log10(VS30)-log10(numu))/(nusigma*sqrt(2));
        lnmuZ25    = log(10)*th1*(1+erf(dnm))+log(10)*th0;
        deltaZ25 = log(Z25)-lnmuZ25; %4.12
        if deltaZ25<=e1/e3
            Fb = e1;
        elseif and(e1/e3<deltaZ25,deltaZ25<e2/e3)
            Fb       = e3*deltaZ25;
        else
            Fb = e2;
        end
    end
    
    FS = Flin+Fnl+Fb;
end

lny= c0 + FP + FM + FD + FS;

%% ALEATORY VARIABILITY
R1 = 200;
R2 = 500;

phi2  = (PhiTot_Phi2squared-PhiTot_Phi1squared)/log(R2/R1)*log(Rrup/R1)+PhiTot_Phi1squared;
phi2(Rrup<=R1)=PhiTot_Phi1squared;
phi2(Rrup>=R2)=PhiTot_Phi2squared;

if VS30<=V1
    DVar = PhiTot_PhiVsquared*log(R2./max(R1,min(R2,Rrup)))/log(R2/R1);
elseif and(V1<VS30,VS30<V2)
    DVar = PhiTot_PhiVsquared*log(V2/VS30)/log(V2/V1)*log(R2./max(R1,min(R2,Rrup)))/log(R2/R1);
elseif VS30>=V2
    DVar = 0;
end

tau   = tau*ones(size(Rrup));
phi   = sqrt(phi2+DVar);


function[coef]=Parker2020coefficients(index,IF)

if IF % interface
    switch index
        case 1,  coef=[8.15 8.255 7.207 8.28 8.329 8.56 -1.661 0.1 -3.95E-03 -4.04E-03 NaN -1.53E-03 -2.39E-03 -3.11E-04 -5.14E-03 1.336 -0.039 1.844 270 850 760 -0.738 -0.454 -0.601 -1.031 -0.671 -0.738 -0.681 -0.59 -0.31763 -0.0052 -0.137 0.137 0.091 0 0.115 0.068 -0.115 0];
        case 2,  coef=[3.93 3.501 2.996 4.644 4.566 3.855 -1.662 0.1 -6.57E-03 -5.41E-03 NaN -3.87E-03 -8.62E-03 -3.97E-03 -7.87E-03 1.246 -0.021 1.128 270 1350 760 -0.586 -0.44 -0.498 -0.785 -0.572 -0.586 -0.333 -0.44 -0.44169 -0.0052 0 0 1 0 0 1 0 0];
        case 3,  coef=[3.557 3.15 2.698 4.291 4.212 3.472 -1.587 0.1 -6.57E-03 -5.41E-03 NaN -3.87E-03 -8.62E-03 -3.97E-03 -7.87E-03 1.246 -0.021 1.128 270 1300 760 -0.604 -0.44 -0.498 -0.803 -0.571 -0.604 -0.333 -0.44 -0.4859 -0.0052 0 0 1 0 0 1 0 0];
        case 4,  coef=[3.602 3.216 2.785 4.373 4.308 3.533 -1.593 0.1 -6.57E-03 -5.41E-03 NaN -3.87E-03 -8.62E-03 -3.97E-03 -7.87E-03 1.227 -0.021 1.128 270 1250 760 -0.593 -0.458 -0.478 -0.785 -0.575 -0.593 -0.345 -0.458 -0.4859 -0.00518 0 0 1 0 0 1 0 0];
        case 5,  coef=[3.671 3.29 2.9 4.488 4.438 3.627 -1.607 0.1 -6.57E-03 -5.41E-03 NaN -3.87E-03 -8.62E-03 -3.97E-03 -7.87E-03 1.221 -0.021 1.128 270 1200 760 -0.579 -0.459 -0.471 -0.761 -0.58 -0.579 -0.36 -0.464 -0.4859 -0.00515 0 0 1 0 0 1 0 0];
        case 6,  coef=[3.795 3.437 3.062 4.626 4.587 3.734 -1.63 0.1 -6.57E-03 -5.41E-03 NaN -3.87E-03 -8.62E-03 -3.97E-03 -7.87E-03 1.215 -0.021 1.128 270 1200 760 -0.561 -0.461 -0.449 -0.733 -0.573 -0.561 -0.37 -0.466 -0.4908 -0.00511 0 0 1 0 0 1 0 0];
        case 7,  coef=[3.944 3.667 3.265 4.839 4.798 3.892 -1.657 0.1 -6.57E-03 -5.41E-03 NaN -3.87E-03 -8.62E-03 -3.97E-03 -7.87E-03 1.207 -0.021 1.128 270 1200 760 -0.508 -0.451 -0.426 -0.641 -0.564 -0.508 -0.402 -0.467 -0.49569 -0.00505 0 0 1 0 0 1 0 0];
        case 8,  coef=[4.145 3.9 3.498 5.092 5.042 4.08 -1.687 0.1 -6.57E-03 -5.41E-03 NaN -3.87E-03 -8.62E-03 -3.97E-03 -7.87E-03 1.201 -0.021 1.128 270 1200 760 -0.454 -0.444 -0.405 -0.529 -0.533 -0.454 -0.424 -0.465 -0.49823 -0.00497 0 0 1 0.1 -0.1 -0.063 -0.05 0];
        case 9,  coef=[4.488 4.16 3.758 5.374 5.31 4.308 -1.715 0.1 -6.57E-03 -5.41E-03 NaN -3.87E-03 -8.62E-03 -3.97E-03 -7.87E-03 1.19 -0.021 1.128 270 1350 760 -0.237 -0.449 -0.402 -0.518 -0.481 -0.376 -0.458 -0.469 -0.49724 -0.00489 0.05 -0.043 -0.025 0.3 -0.34 -0.2 -0.075 0.078];
        case 10, coef=[4.701 4.38 3.966 5.629 5.545 4.53 -1.737 0.1 -6.57E-03 -5.41E-03 NaN -3.87E-03 -8.62E-03 -3.97E-03 -7.87E-03 1.182 -0.021 1.128 270 1450 760 -0.179 -0.457 -0.42 -0.55 -0.446 -0.405 -0.48 -0.475 -0.49471 -0.00478 0.1 -0.085 -0.05 0.333 -0.377 -0.222 -0.081 0.075];
        case 11, coef=[4.865 4.537 4.085 5.793 5.686 4.685 -1.745 0.1 -6.57E-03 -5.41E-03 NaN -3.87E-03 -8.62E-03 -3.97E-03 -7.87E-03 1.171 -0.021 1.162 270 1500 760 -0.196 -0.477 -0.558 -0.69 -0.463 -0.565 -0.527 -0.491 -0.48583 -0.0046 0.164 -0.139 -0.082 0.29 -0.29 -0.193 -0.091 0.064];
        case 12, coef=[4.874 4.533 4.083 5.798 5.682 4.734 -1.732 0.1 -6.57E-03 -5.41E-03 NaN -3.87E-03 -8.62E-03 -3.97E-03 -7.87E-03 1.163 -0.021 1.187 270 1400 760 -0.254 -0.511 -0.641 -0.857 -0.506 -0.69 -0.562 -0.509 -0.47383 -0.00434 0.164 -0.139 -0.082 0.177 -0.192 -0.148 -0.092 0.075];
        case 13, coef=[4.675 4.369 3.933 5.572 5.518 4.632 -1.696 0.1 -6.57E-03 -5.41E-03 NaN -3.87E-03 -8.62E-03 -3.97E-03 -7.87E-03 1.156 -0.021 1.204 270 1350 760 -0.383 -0.524 -0.711 -1.031 -0.598 -0.804 -0.653 -0.549 -0.47696 -0.00402 0.08 -0.08 -0.053 0.1 -0.035 -0.054 0 0];
        case 14, coef=[4.42 4.14 3.622 5.259 5.233 4.42 -1.643 0.1 -6.57E-03 -5.41E-03 NaN -3.87E-03 -8.62E-03 -3.97E-03 -7.87E-03 1.151 -0.021 1.215 270 1300 760 -0.428 -0.519 -0.73 -1.205 -0.651 -0.872 -0.7 -0.587 -0.4845 -0.0037 0 0 1 0 0 1 0 0];
        case 15, coef=[4.004 3.757 3.233 4.75 4.767 4.156 -1.58 0.1 -6.57E-03 -5.41E-03 NaN -3.87E-03 -8.62E-03 -3.97E-03 -7.87E-03 1.143 -0.022 1.227 270 1150 760 -0.537 -0.522 -0.801 -1.27 -0.742 -0.972 -0.828 -0.639 -0.48105 -0.00342 -0.13 0.113 0.087 0 0.05 0.2 0 0];
        case 16, coef=[3.543 3.318 2.801 4.317 4.351 3.842 -1.519 0.1 -6.57E-03 -5.41E-03 NaN -3.87E-03 -8.62E-03 -3.97E-03 -7.87E-03 1.143 -0.023 1.234 270 1000 760 -0.671 -0.494 -0.856 -1.302 -0.909 -0.995 -0.884 -0.695 -0.46492 -0.00322 -0.2 0.176 0.118 0 0.1 0.2 0 0];
        case 17, coef=[2.9 2.55 2.1 3.54 3.585 3.378 -1.44 0.1 -6.57E-03 -4.67E-03 NaN -3.35E-03 -7.46E-03 -3.44E-03 -6.80E-03 1.217 -0.026 1.24 270 900 760 -1.067 -0.493 -0.911 -1.38 -0.958 -1.093 -0.942 -0.745 -0.43439 -0.00312 -0.401 0.284 0.167 0 0.2 0.125 -0.2 0.012];
        case 18, coef=[2.481 2.097 1.7 3.056 3.147 3.054 -1.419 0.1 -6.13E-03 -4.15E-03 NaN -2.97E-03 -6.63E-03 -3.05E-03 -6.05E-03 1.27 -0.028 1.24 270 800 760 -1.083 -0.501 -0.926 -1.448 -0.932 -1.083 -0.96 -0.777 -0.38484 -0.0031 -0.488 0.346 0.203 0 0.245 0.153 -0.245 0.037];
        case 19, coef=[1.891 1.5 1.161 2.438 2.611 2.621 -1.408 0.1 -5.05E-03 -3.42E-03 NaN -2.45E-03 -5.46E-03 -2.52E-03 -4.98E-03 1.344 -0.031 1.237 270 760 760 -0.968 -0.491 -0.888 -1.516 -0.903 -0.968 -0.942 -0.79 -0.32318 -0.0031 -0.578 0.48 0.24 0 0.32 0.2 -0.32 0.064];
        case 20, coef=[1.4 0.95 0.669 1.923 2.122 2.23 -1.391 0.1 -4.29E-03 -2.90E-03 NaN -2.08E-03 -4.63E-03 -2.14E-03 -4.23E-03 1.396 -0.034 1.232 270 760 760 -0.876 -0.471 -0.837 -1.426 -0.74 -0.876 -0.903 -0.775 -0.26577 -0.0031 -0.645 0.579 0.254 0 0.37 0.239 -0.28 0.14];
        case 21, coef=[1.084 0.617 0.287 1.55 1.79 1.959 -1.394 0.1 -3.69E-03 -2.50E-03 NaN -1.79E-03 -3.99E-03 -1.84E-03 -3.64E-03 1.437 -0.036 1.227 270 760 760 -0.835 -0.474 -0.716 -1.378 -0.681 -0.835 -0.848 -0.74 -0.21236 -0.0031 -0.678 0.609 0.267 0 0.4 0.264 -0.313 0.19];
        case 22, coef=[0.848 0.36 0.086 1.3 1.61 1.764 -1.416 0.1 -3.21E-03 -2.17E-03 NaN -1.56E-03 -3.47E-03 -1.60E-03 -3.16E-03 1.47 -0.038 1.223 270 760 760 -0.745 -0.437 -0.672 -1.338 -0.574 -0.745 -0.8 -0.694 -0.17807 -0.0031 -0.772 0.635 0.265 0 0.43 0.287 -0.355 0.165];
        case 23, coef=[0.601 -0.017 -0.185 0.97 1.409 1.448 -1.452 0.1 -2.44E-03 -1.65E-03 NaN -1.18E-03 -2.64E-03 -1.22E-03 -2.41E-03 1.523 -0.044 1.216 270 760 760 -0.687 -0.394 -0.6 -1.295 -0.534 -0.687 -0.716 -0.622 -0.13729 -0.0031 -0.699 0.709 0.259 0 0.44 0.303 -0.417 0.163];
        case 24, coef=[0.425 -0.177 -0.304 0.862 1.283 1.275 -1.504 0.1 -1.60E-03 -1.25E-03 NaN -8.95E-04 -2.00E-03 -9.19E-04 -1.82E-03 1.564 -0.048 1.21 270 760 760 -0.614 -0.363 -0.519 -1.278 -0.491 -0.614 -0.668 -0.543 -0.07733 -0.0031 -0.642 0.63 0.215 0 0.45 0.321 -0.45 0.132];
        case 25, coef=[0.063 -0.554 -0.706 0.455 1.05 0.851 -1.569 0.1 -7.66E-04 -5.19E-04 NaN -3.71E-04 -8.28E-04 -3.82E-04 -7.55E-04 1.638 -0.059 1.2 270 760 760 -0.52 -0.311 -0.418 -1.196 -0.357 -0.52 -0.5 -0.468 -0.05443 -0.0031 -0.524 0.306 0.175 0 0.406 0.312 -0.35 0.15];
        case 26, coef=[0 -0.63 -0.617 0.455 1.02 0.807 -1.676 0.1 0.00E+00 0.00E+00 NaN 0.00E+00 0.00E+00 0.00E+00 0.00E+00 1.69 -0.067 1.194 270 760 760 -0.395 -0.261 -0.321 -1.06 -0.302 -0.395 -0.42 -0.352 -0.03313 -0.0031 -0.327 0.182 0.121 0 0.345 0.265 -0.331 0.117];
    end
    
end


if ~IF % slab
    switch index
        case 1,  coef=[12.936 12.79 13.6 12.81 13.248 12.754 12.927 13.516 -2.422 0.1 -1.90E-03 -2.38E-03 -1.09E-03 -1.92E-03 -2.15E-03 -1.92E-03 -3.66E-03 1.84 -0.05 0.8 0.2693 0.0252 67 270 850 760 -0.738 -0.454 -0.601 -1.031 -0.671 -0.738 -0.681 -0.59 -0.31763 -0.0052 0];
        case 2,  coef=[9.644 9.404 9.912 9.58 10.145 9.254 9.991 10.071 -2.543 0.1 -2.55E-03 -2.27E-03 -3.54E-03 -2.38E-03 -3.35E-03 -2.38E-03 -3.62E-03 1.84 -0.05 0.4 0.3004 0.0314 67 270 1350 760 -0.586 -0.44 -0.498 -0.785 -0.572 -0.586 -0.333 -0.44 -0.44169 -0.0052 0];
        case 3,  coef=[9.695 9.451 9.954 9.612 10.162 9.293 9.994 10.174 -2.554 0.1 -2.55E-03 -2.19E-03 -4.01E-03 -2.17E-03 -3.11E-03 -2.17E-03 -3.55E-03 1.84 -0.05 0.4 0.2839 0.0296 67 270 1300 760 -0.604 -0.44 -0.498 -0.803 -0.571 -0.604 -0.333 -0.44 -0.4859 -0.0052 0];
        case 4,  coef=[9.85 9.587 10.086 9.771 10.306 9.403 10.152 10.273 -2.566 0.1 -2.55E-03 -2.19E-03 -4.01E-03 -2.17E-03 -3.11E-03 -2.17E-03 -3.55E-03 1.884 -0.05 0.415 0.2854 0.0298 67 270 1250 760 -0.593 -0.458 -0.478 -0.785 -0.575 -0.593 -0.345 -0.458 -0.4859 -0.00518 0];
        case 5,  coef=[9.948 9.667 10.172 9.85 10.387 9.481 10.292 10.329 -2.578 0.1 -2.55E-03 -2.19E-03 -4.01E-03 -2.17E-03 -3.11E-03 -2.17E-03 -3.55E-03 1.884 -0.05 0.43 0.2891 0.0302 67 270 1200 760 -0.579 -0.459 -0.471 -0.761 -0.58 -0.579 -0.36 -0.464 -0.4859 -0.00515 0];
        case 6,  coef=[10.069 9.808 10.302 9.993 10.498 9.592 10.459 10.451 -2.594 0.1 -2.55E-03 -2.19E-03 -4.01E-03 -2.17E-03 -3.11E-03 -2.17E-03 -3.55E-03 1.884 -0.05 0.445 0.2932 0.0306 67 270 1200 760 -0.561 -0.461 -0.449 -0.733 -0.573 -0.561 -0.37 -0.466 -0.4908 -0.00511 0];
        case 7,  coef=[10.346 10.086 10.602 10.317 10.744 9.834 10.818 10.678 -2.629 0.1 -2.55E-03 -2.19E-03 -4.01E-03 -2.17E-03 -3.11E-03 -2.17E-03 -3.55E-03 1.884 -0.05 0.46 0.3004 0.0313 67 270 1200 760 -0.508 -0.451 -0.426 -0.641 -0.564 -0.508 -0.402 -0.467 -0.49569 -0.00505 0];
        case 8,  coef=[10.517 10.379 10.862 10.563 10.981 10.027 11.102 10.86 -2.649 0.1 -2.55E-03 -2.19E-03 -4.01E-03 -2.17E-03 -3.11E-03 -2.17E-03 -3.55E-03 1.884 -0.05 0.475 0.3048 0.0316 67 270 1200 760 -0.454 -0.444 -0.405 -0.529 -0.533 -0.454 -0.424 -0.465 -0.49823 -0.00497 0];
        case 9,  coef=[10.834 10.65 11.184 10.785 11.25 10.265 11.424 11.093 -2.65 0.1 -2.55E-03 -2.19E-03 -4.01E-03 -2.17E-03 -3.11E-03 -2.17E-03 -3.55E-03 1.884 -0.05 0.49 0.2992 0.0321 67 270 1350 760 -0.237 -0.449 -0.402 -0.518 -0.481 -0.376 -0.458 -0.469 -0.49724 -0.00489 0.05];
        case 10, coef=[10.971 10.816 11.304 10.841 11.466 10.467 11.49 11.283 -2.647 0.1 -2.55E-03 -2.19E-03 -4.01E-03 -2.17E-03 -3.11E-03 -2.17E-03 -3.55E-03 1.884 -0.05 0.505 0.2854 0.032 67 270 1450 760 -0.179 -0.457 -0.42 -0.55 -0.446 -0.405 -0.48 -0.475 -0.49471 -0.00478 0.1];
        case 11, coef=[11.037 10.883 11.402 10.809 11.619 10.566 11.32 11.503 -2.634 0.1 -2.55E-03 -2.19E-03 -4.01E-03 -2.17E-03 -3.11E-03 -2.17E-03 -3.55E-03 1.884 -0.06 0.52 0.2814 0.0325 67 270 1500 760 -0.196 -0.477 -0.558 -0.69 -0.463 -0.565 -0.527 -0.491 -0.48583 -0.0046 0.164];
        case 12, coef=[10.758 10.633 11.183 10.519 11.351 10.33 10.927 11.32 -2.583 0.1 -2.55E-03 -2.19E-03 -4.01E-03 -2.17E-03 -3.11E-03 -2.17E-03 -3.55E-03 1.884 -0.068 0.535 0.291 0.0306 67 270 1400 760 -0.254 -0.511 -0.641 -0.857 -0.506 -0.69 -0.562 -0.509 -0.47383 -0.00434 0.164];
        case 13, coef=[10.498 10.322 10.965 10.268 11.063 10.124 10.555 11.147 -2.539 0.1 -2.55E-03 -2.19E-03 -4.01E-03 -2.17E-03 -3.11E-03 -2.17E-03 -3.55E-03 1.884 -0.075 0.55 0.2758 0.0306 67 270 1350 760 -0.383 -0.524 -0.711 -1.031 -0.598 -0.804 -0.653 -0.549 -0.47696 -0.00402 0.08];
        case 14, coef=[10.386 10.116 10.87 10.134 10.878 10.077 10.328 11.079 -2.528 0.1 -2.55E-03 -2.19E-03 -4.01E-03 -2.17E-03 -3.11E-03 -2.17E-03 -3.55E-03 1.884 -0.082 0.565 0.2719 0.0323 67 270 1300 760 -0.428 -0.519 -0.73 -1.205 -0.651 -0.872 -0.7 -0.587 -0.4845 -0.0037 0];
        case 15, coef=[9.807 9.561 10.411 9.598 10.296 9.539 9.639 10.547 -2.452 0.1 -2.55E-03 -2.19E-03 -4.01E-03 -2.17E-03 -3.11E-03 -2.17E-03 -3.55E-03 1.884 -0.091 0.58 0.2539 0.0302 67 270 1150 760 -0.537 -0.522 -0.801 -1.27 -0.742 -0.972 -0.828 -0.639 -0.48105 -0.00342 -0.13];
        case 16, coef=[9.289 8.973 9.901 9.097 9.711 9.03 9.03 10.049 -2.384 0.1 -2.55E-03 -2.19E-03 -4.01E-03 -2.17E-03 -3.11E-03 -2.17E-03 -3.55E-03 1.884 -0.1 0.595 0.2482 0.0295 67 270 1000 760 -0.671 -0.494 -0.856 -1.302 -0.909 -0.995 -0.884 -0.695 -0.46492 -0.00322 -0.2];
        case 17, coef=[8.559 8.246 9.335 8.324 8.934 8.258 8.258 9.327 -2.338 0.1 -2.11E-03 -1.89E-03 -3.47E-03 -1.88E-03 -2.69E-03 -1.88E-03 -3.07E-03 1.884 -0.115 0.61 0.2227 0.0266 67 270 900 760 -1.067 -0.493 -0.911 -1.38 -0.958 -1.093 -0.942 -0.745 -0.43439 -0.00312 -0.401];
        case 18, coef=[7.805 7.507 8.68 7.557 8.164 7.467 7.417 8.504 -2.267 0.1 -1.87E-03 -1.68E-03 -3.09E-03 -1.67E-03 -2.39E-03 -1.67E-03 -2.73E-03 1.884 -0.134 0.625 0.1969 0.0231 67 270 800 760 -1.083 -0.501 -0.926 -1.448 -0.932 -1.083 -0.96 -0.777 -0.38484 -0.0031 -0.488];
        case 19, coef=[6.524 6.213 7.581 6.35 6.896 6.22 6.18 7.204 -2.166 0.1 -1.54E-03 -1.39E-03 -2.54E-03 -1.38E-03 -1.97E-03 -1.38E-03 -2.25E-03 1.884 -0.154 0.64 0.1452 0.0118 67 270 760 760 -0.968 -0.491 -0.888 -1.516 -0.903 -0.968 -0.942 -0.79 -0.32318 -0.0031 -0.578];
        case 20, coef=[5.605 5.206 6.671 5.434 5.935 5.261 5.161 6.227 -2.077 0.1 -1.31E-03 -1.18E-03 -2.16E-03 -1.17E-03 -1.67E-03 -1.17E-03 -1.91E-03 1.884 -0.154 0.655 0.06 0.007 67 270 760 760 -0.876 -0.471 -0.837 -1.426 -0.74 -0.876 -0.903 -0.775 -0.26577 -0.0031 -0.645];
        case 21, coef=[4.982 4.594 6.047 4.773 5.234 4.567 4.517 5.517 -2.015 0.1 -1.13E-03 -1.01E-03 -1.86E-03 -1.01E-03 -1.44E-03 -1.01E-03 -1.64E-03 1.884 -0.154 0.67 0 0 0 270 760 760 -0.835 -0.474 -0.716 -1.378 -0.681 -0.835 -0.848 -0.74 -0.21236 -0.0031 -0.678];
        case 22, coef=[4.562 4.206 5.667 4.441 4.849 4.176 4.076 5.157 -2.012 0.1 -9.79E-04 -8.80E-04 -1.61E-03 -8.73E-04 -1.25E-03 -8.73E-04 -1.43E-03 1.949 -0.154 0.685 0 0 0 270 760 760 -0.745 -0.437 -0.672 -1.338 -0.574 -0.745 -0.8 -0.694 -0.17807 -0.0031 -0.772];
        case 23, coef=[3.887 3.517 4.97 3.849 4.074 3.495 3.445 4.55 -1.989 0.1 -7.45E-04 -6.70E-04 -1.23E-03 -6.64E-04 -9.52E-04 -6.64E-04 -1.09E-03 2.031 -0.154 0.7 0 0 0 270 760 760 -0.687 -0.394 -0.6 -1.295 -0.534 -0.687 -0.716 -0.622 -0.13729 -0.0031 -0.699];
        case 24, coef=[3.529 3.142 4.592 3.502 3.814 3.038 3.038 4.229 -1.998 0.1 -5.64E-04 -5.07E-04 -9.29E-04 -5.03E-04 -7.20E-04 -5.03E-04 -8.22E-04 2.131 -0.154 0.715 0 0 0 270 760 760 -0.614 -0.363 -0.519 -1.278 -0.491 -0.614 -0.668 -0.543 -0.07733 -0.0031 -0.642];
        case 25, coef=[2.857 2.391 3.65 2.821 3.152 2.368 2.368 3.554 -2.019 0.1 -2.34E-04 -2.10E-04 -3.85E-04 -2.09E-04 -2.99E-04 -2.09E-04 -3.41E-04 2.185 -0.154 0.73 0 0 0 270 760 760 -0.52 -0.311 -0.418 -1.196 -0.357 -0.52 -0.5 -0.468 -0.05443 -0.0031 -0.524];
        case 26, coef=[2.417 2.031 2.95 2.408 2.791 1.939 1.939 3.166 -2.047 0.1 0.00E+00 0.00E+00 0.00E+00 0.00E+00 0.00E+00 0.00E+00 0.00E+00 2.35 -0.154 0.745 0 0 0 270 760 760 -0.395 -0.261 -0.321 -1.06 -0.302 -0.395 -0.42 -0.352 -0.03313 -0.0031 -0.327];
    end
end

switch index
    case 1,  st=[0.543 0.348 0.288 -0.179 0.142 0.047 423 0.153109749 0.166470189 0.011083117 422.7739825];
    case 2,  st=[0.583 0.396 0.565 -0.18 0.221 0.093 423 0.148503376 0.326792762 0.0678988 422.7250144];
    case 3,  st=[0.562 0.397 0.56 -0.18 0.223 0.098 423 0.147744002 0.294300953 0.071142574 422.7250144];
    case 4,  st=[0.564 0.401 0.563 -0.181 0.227 0.105 423 0.148940464 0.293648582 0.072945972 422.7250144];
    case 5,  st=[0.565 0.405 0.575 -0.183 0.231 0.12 423 0.149552271 0.310002504 0.075580358 422.7250144];
    case 6,  st=[0.571 0.413 0.589 -0.188 0.239 0.145 423 0.152725531 0.3126263 0.077338954 422.7250144];
    case 7,  st=[0.591 0.439 0.616 -0.205 0.261 0.177 423 0.159274461 0.322406937 0.079899847 422.7250144];
    case 8,  st=[0.605 0.473 0.653 -0.23 0.285 0.2 423 0.167453663 0.330377055 0.07749712 422.7497529];
    case 9,  st=[0.617 0.529 0.722 -0.262 0.339 0.205 423 0.183795246 0.299252046 0.063458414 422.7497529];
    case 10, st=[0.617 0.517 0.712 -0.239 0.347 0.185 423 0.176328054 0.310094493 0.060775396 422.7497529];
    case 11, st=[0.612 0.457 0.644 -0.185 0.313 0.123 423 0.163756446 0.306667088 0.075641876 422.7497529];
    case 12, st=[0.596 0.432 0.64 -0.138 0.277 0.11 423 0.162731374 0.300846435 0.069661904 422.7497529];
    case 13, st=[0.58 0.45 0.633 -0.185 0.26 0.119 423 0.169273216 0.233186564 0.076695784 422.7497529];
    case 14, st=[0.567 0.436 0.584 -0.158 0.254 0.092 423 0.159096144 0.219753704 0.065447682 422.733953];
    case 15, st=[0.552 0.433 0.556 -0.19 0.23 0.044 423 0.157555064 0.222054825 0.064227885 422.7092553];
    case 16, st=[0.545 0.428 0.51 -0.186 0.225 0.038 423 0.160191203 0.243141143 0.044153692 422.6287449];
    case 17, st=[0.537 0.448 0.471 -0.177 0.218 0.04 422 0.175434903 0.24080601 0.040104175 422.4208545];
    case 18, st=[0.531 0.43 0.43 -0.166 0.227 0.015 422 0.195291598 0.195291598 0.042548826 422.0612593];
    case 19, st=[0.529 0.406 0.406 -0.111 0.244 -0.047 422 0.204301677 0.204301677 -0.034354335 422.1975086];
    case 20, st=[0.529 0.393 0.393 0 0.231 -0.036 422 0.195565981 0.195565981 -0.036012089 421.6670704];
    case 21, st=[0.529 0.381 0.381 0 0.222 -0.025 421 0.169244999 0.169244999 -0.028543311 420.5346656];
    case 22, st=[0.529 0.367 0.367 0 0.199 -0.03 419 0.176694931 0.176694931 -0.01092846 418.6202059];
    case 23, st=[0.529 0.33 0.33 0 0.191 -0.042 416 0.158378069 0.158378069 0.032753085 415.9808729];
    case 24, st=[0.529 0.298 0.298 0 0.181 0.005 415 0.132116941 0.132116941 0.013877623 415.1157232];
    case 25, st=[0.529 0.254 0.254 0 0.181 -0.016 419 0.112639086 0.112639086 0.015844466 419.1328522];
    case 26, st=[0.529 0.231 0.231 0 0.181 0.04 427 0.110487852 0.110487852 0.016811417 426.6111857];
end

coef = [coef,st];

