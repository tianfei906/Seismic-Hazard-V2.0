clearvars
clc
%% MR1,MR2,MR3 hazard curves
% MR1 Hazard
if 1
    BM1=[1	0.0391740215953683	0.0318982519637105	0.0394104227953934	0.0454948159413144
1.26896100316792	0.0370437999145668	0.0297357582803461	0.0372873749949287	0.0434668534900331
1.61026202756094	0.0351606888890018	0.0278667561194244	0.0354640145483594	0.0415898834819592
2.04335971785694	0.0334850156892002	0.0261777489287595	0.0339334745647976	0.0398754681855319
2.59294379740467	0.031900550375725	0.0245917518608999	0.032503048746332	0.0382349269228302
3.29034456231267	0.030280621147933	0.0230619674055284	0.0310048383073436	0.0364894721055707
4.1753189365604	0.028574954975657	0.021563425787564	0.0294383590578029	0.034513608585536
5.29831690628371	0.0268173591603254	0.0200851854590798	0.0279132524725495	0.0323240153038695
6.72335753649934	0.0250753936120895	0.0186243477934216	0.0265318802793018	0.030042257951411
8.53167852417281	0.0234106566951927	0.0171817730518878	0.0253387200199576	0.0278223943834389
10.8263673387405	0.0218631280318621	0.0157588992285211	0.0243534868469751	0.0257759970417324
13.7382379588326	0.0204624363333911	0.0143554880583682	0.023628358864789	0.0239637462666188
17.4332882219999	0.0192368800117177	0.0129687857680382	0.0231907846817826	0.0224737487070253
22.1221629107045	0.0181819560532196	0.0115947194071304	0.0229372661657503	0.0214042535200619
28.0721620394118	0.0172274765285027	0.0102310552546613	0.0226540861827646	0.0207373822630262
35.6224789026244	0.0162501395331138	0.00888133657049684	0.0220782369008758	0.0203147133161873
45.2035365636024	0.0151109511970677	0.00755771862934448	0.0209209005758922	0.019906787765904
57.3615251044868	0.0137076498711633	0.00628111925206911	0.0190076425080868	0.0192612086848147
72.7895384398315	0.0120358343872065	0.00507833845806289	0.0164876874537369	0.018156388494886
92.3670857187386	0.0101874907871423	0.00397729897513788	0.0137550598332556	0.016467589439412
117.210229753348	0.00827479653734251	0.0030023539168712	0.0110959864747773	0.0142043857178362
148.735210729351	0.00637730887911496	0.00217109080254838	0.00848932324780361	0.0115459676632854
188.73918221351	0.00455710724090798	0.00149271476118653	0.00577324887609498	0.00881404557185888
239.502661998749	0.00290693346099237	0.000967213644839019	0.00313618046690307	0.00626823301163616
303.91953823132	0.00157435171166219	0.00058486439431286	0.00121614983953878	0.00401534345906263
385.662042116347	0.000690676083925484	0.000326681756780334	0.000308656936958123	0.00221556936517292
489.390091847749	0.00023887664195581	0.000166837826057035	4.84431475028045e-05	0.00103463950512878
621.016941891562	6.44737653951119e-05	7.71262168973223e-05	4.5398876013177e-06	0.000412355924776531
788.046281566991	1.34880662112069e-05	3.19483555406623e-05	2.4858098845014e-07	0.000141233235468533
1000	2.16892824561242e-06	1.17330702148365e-05	7.84230885466802e-09	4.14687794033874e-05];

    BU1=[1	1	0.114634858114485	0.907550574423862	0.15658102830149
1.26896100316792	1	0.100545324590981	0.759100641225176	0.138345416713058
1.61026202756094	1	0.0888653122135396	0.582209055666436	0.12172793328492
2.04335971785694	1	0.0762137449085101	0.402892143261456	0.106634813408189
2.59294379740467	1	0.0642937679334959	0.248251924495843	0.0929735913352825
3.29034456231267	1	0.0554494133076455	0.134800895945994	0.0806535167966236
4.1753189365604	1	0.0478416569067482	0.0639942016724323	0.0695881867137507
5.29831690628371	1	0.0397020180846549	0.026400702768476	0.0596962531360051
6.72335753649934	1	0.0325584904789121	0.00942162912629407	0.0508990124851167
8.53167852417281	1	0.0274558145606461	0.00289834861892541	0.0431191205589569
10.8263673387405	1	0.0229665886385888	0.000766507584157327	0.0362815273577929
13.7382379588326	1	0.0183358677969554	0.000173904090116649	0.0303132466808992
17.4332882219999	1	0.014566552547038	3.37917546126296e-05	0.0251415014876018
22.1221629107045	1	0.0119584041245034	5.61623900431246e-06	0.0206933500371598
28.0721620394118	1	0.00963419488227374	7.97539067980469e-07	0.0168972555763769
35.6224789026244	1	0.00735567207722262	9.66837079591375e-08	0.0136840741019879
45.2035365636024	1	0.00563527835509694	9.99861174562422e-09	0.0109869170562029
57.3615251044868	1	0.00447140476862525	8.81563876001595e-10	0.00874159175956088
72.7895384398315	1	0.00342790556770377	6.62338304260726e-11	0.006887845542469
92.3670857187386	1	0.0024649322174905	4.23872350982391e-12	0.00537003362758408
117.210229753348	1	0.00178939048984162	2.30939953697354e-13	0.00413698983197155
148.735210729351	1	0.00133315130222309	1.06974910432017e-14	0.00314217440488789
188.73918221351	1	0.000901343404664056	3.77558507407117e-16	0.00234450122488719
239.502661998749	1	0.000494229642414711	NaN	0.00170927181289333
303.91953823132	1	0.000216039524739382	NaN	0.00120867468621639
385.662042116347	1	8.0984515628846e-05	NaN	0.000821446185101216
489.390091847749	1	2.88565480158584e-05	NaN	0.000531224617199671
621.016941891562	1	1.00056654765685e-05	NaN	0.000323791770853024
788.046281566991	1	3.24638236554995e-06	NaN	0.000184569231111514
1000	1	9.59074397478094e-07	NaN	9.78829154276575e-05];
end
% MR2 Hazard
if 2
    BM2=[1	1	0.00841723401728045	0.0100472003902838	0.0113502258504276
1.26896100316792	1	0.00787861724569984	0.00958059364259574	0.0109164832294825
1.61026202756094	1	0.00741058243237665	0.00916852649491626	0.0105226348151176
2.04335971785694	1	0.0069849083913798	0.00881102041021516	0.0101618296340449
2.59294379740467	1	0.00658247499826579	0.0084641712898256	0.00981014832669214
3.29034456231267	1	0.00619203406978322	0.00808774064282674	0.00942542855743041
4.1753189365604	1	0.0058081358592396	0.00768063421547316	0.00897530924577278
5.29831690628371	1	0.00542899764721813	0.00726983185952334	0.00845759478390934
6.72335753649934	1	0.00505475693841356	0.00688295077593529	0.0078959304759308
8.53167852417281	1	0.00468616335133407	0.00653487020533841	0.0073263733711636
10.8263673387405	1	0.00432359905624312	0.00623677933123444	0.00677911106327994
13.7382379588326	1	0.00396640764255673	0.00601231044447946	0.00627483612906994
17.4332882219999	1	0.00361268642836933	0.00587803975939807	0.00584489850916782
22.1221629107045	1	0.0032597401153347	0.0058098338483194	0.00552634709798026
28.0721620394118	1	0.00290519683951409	0.0057518284718306	0.00532438568901269
35.6224789026244	1	0.00254844261020469	0.00563923596180491	0.00520315954770683
45.2035365636024	1	0.0021917754169213	0.00540201691650369	0.00510743893228493
57.3615251044868	1	0.00184072182219619	0.00498812299233182	0.00497681117228464
72.7895384398315	1	0.00150331878521663	0.0044096393627985	0.00475280445637207
92.3670857187386	1	0.00118865660596654	0.00373854353060546	0.00438802905491981
117.210229753348	1	0.000905291214607391	0.00304302559058246	0.00385849377510615
148.735210729351	1	0.000660034336483458	0.00233836155407034	0.0031888481546953
188.73918221351	1	0.000457228227235144	0.00160015535155706	0.00246490600887408
239.502661998749	1	0.000298307114694884	0.000877947052097575	0.00177629289834885
303.91953823132	1	0.000181516191437947	0.000344201380355523	0.00116153515906625
385.662042116347	1	0.000101966164172317	8.81933257574109e-05	0.000658257983320685
489.390091847749	1	5.23437981890278e-05	1.39441427096687e-05	0.000315273522334512
621.016941891562	1	2.4310469280112e-05	1.31389979234715e-06	0.000128008452516571
788.046281566991	1	1.01122924768734e-05	7.22261049365077e-08	4.43782638402336e-05
1000	1	3.72749877741483e-06	2.285114268349e-09	1.3137802444746e-05];    
    BU2=[1	1	0.0272833244428579	0.16744251699317	0.0358429180793481
1.26896100316792	1	0.0242840546087866	0.140053596570706	0.032094942681935
1.61026202756094	1	0.0217257289204889	0.107417208962588	0.0286242525129106
2.04335971785694	1	0.0188975428554702	0.0743333500585322	0.0254196951214391
2.59294379740467	1	0.0162125653282948	0.0458023257958607	0.0224701826111303
3.29034456231267	1	0.0141906813526295	0.0248706815313961	0.0197647437197676
4.1753189365604	1	0.0123981355773896	0.0118068904400209	0.0172930112550241
5.29831690628371	1	0.0104466333612092	0.0048709132543368	0.015045188554505
6.72335753649934	1	0.0087211665434031	0.00173828471882609	0.0130114124445907
8.53167852417281	1	0.00746601960124627	0.000534743519042598	0.011181493545957
10.8263673387405	1	0.00632661533019287	0.000141420172938719	0.00954511865495945
13.7382379588326	1	0.00513328194849825	3.20851965556015e-05	0.0080917090978225
17.4332882219999	1	0.00415401617190728	6.23455772648947e-06	0.00680996111583097
22.1221629107045	1	0.00346093863736199	1.03619260614129e-06	0.0056878187457267
28.0721620394118	1	0.00282288459496771	1.4714546241989e-07	0.00471287830855995
35.6224789026244	1	0.00218875650909566	1.78380840353583e-08	0.00387259915738862
45.2035365636024	1	0.00170571733121418	1.84473765353255e-09	0.00315427813231991
57.3615251044868	1	0.00137069177808625	1.62647987283429e-10	0.00254522039966701
72.7895384398315	1	0.00106123158543239	1.22201005532731e-11	0.00203308758329266
92.3670857187386	1	0.000772493432483917	7.82041853451088e-13	0.00160606176518474
117.210229753348	1	0.00056828600380717	4.26082779418868e-14	0.00125283573921333
148.735210729351	1	0.000427182030077355	1.97368044962418e-15	0.000962737686455546
188.73918221351	1	0.00029038420349488	6.96593099867359e-17	0.000726064238118655
239.502661998749	1	0.000160161033343235	NaN	0.000534449369194823
303.91953823132	1	7.06138525404787e-05	NaN	0.000381121444484761
385.662042116347	1	2.67748177642524e-05	NaN	0.000260902837257375
489.390091847749	1	9.64851826618449e-06	NaN	0.000169770071858229
621.016941891562	1	3.37232035007482e-06	NaN	0.000104032404107257
788.046281566991	1	1.10006386188542e-06	NaN	5.95863915640411e-05
1000	1	3.26308829560014e-07	NaN	3.17451169983185e-05];
end

% MR3 hazard
if 3
    BM3=[1	1	0.00339613940734133	0.00392993100304968	0.00434626720047651
1.26896100316792	1	0.00319270110470369	0.00377632095858065	0.0042024832943594
1.61026202756094	1	0.00301511184081276	0.00363681602080923	0.00407612795550195
2.04335971785694	1	0.00285248267152393	0.00351168674267111	0.00396135791411492
2.59294379740467	1	0.00269741368198668	0.0033856354980239	0.00384826668732554
3.29034456231267	1	0.00254568910840803	0.00324385589530252	0.00372153747931049
4.1753189365604	1	0.00239551489607815	0.00308518903720861	0.0035684218597877
5.29831690628371	1	0.0022466421633078	0.00291917090251346	0.00338554632601241
6.72335753649934	1	0.00209959078655925	0.00275655519630796	0.00317883424380062
8.53167852417281	1	0.00195502704244165	0.00260416618177003	0.00296021185905989
10.8263673387405	1	0.00181327572043754	0.00246888215917504	0.00274118684498863
13.7382379588326	1	0.00167397916753751	0.00236455993434628	0.00253111139258234
17.4332882219999	1	0.0015359866422089	0.00230201826899954	0.00234519354566757
22.1221629107045	1	0.00139757494826559	0.0022727073278827	0.00220267536654666
28.0721620394118	1	0.00125701271940698	0.00225373485639345	0.00211007294442313
35.6224789026244	1	0.00111331659420318	0.00222027391416446	0.00205560653929791
45.2035365636024	1	0.000966911927456243	0.00214672776020674	0.00201875081197977
57.3615251044868	1	0.000819907657653308	0.00201115908788559	0.00197718558177764
72.7895384398315	1	0.000675851979428796	0.00180956298551955	0.00190813847751544
92.3670857187386	1	0.000539076929621743	0.00155857583790993	0.00178903600549061
117.210229753348	1	0.00041391420942055	0.00128076645366949	0.00160159565787556
148.735210729351	1	0.000304045475014541	0.000988719969527599	0.00134597651059187
188.73918221351	1	0.000212071362219188	0.000680205819504758	0.00105421170383077
239.502661998749	1	0.000139229129714304	0.000376368964144284	0.000769470863731735
303.91953823132	1	8.52034352094024e-05	0.000148967332839755	0.0005125235372787
385.662042116347	1	4.81114398213747e-05	3.84928827845154e-05	0.000297393661484751
489.390091847749	1	2.48141127389497e-05	6.12670605677452e-06	0.000145647000039969
621.016941891562	1	1.15736434524171e-05	5.80183430011645e-07	6.0115040620546e-05
788.046281566991	1	4.83257311817193e-06	3.20107404558189e-08	2.1068212002943e-05
1000	1	1.7873587100874e-06	1.01551218825557e-09	6.2836714312626e-06];    

    BU3=[
1	1	0.00998299013938092	0.0473487802529597	0.0126387777326928
1.26896100316792	1	0.00901123143842267	0.0396038418840393	0.0114659740230245
1.61026202756094	1	0.00815761059442127	0.0303750440084658	0.0103617136802888
2.04335971785694	1	0.00719483705039391	0.0210197118425504	0.00932469736564447
2.59294379740467	1	0.00627382122990804	0.0129518135425015	0.00835366581065096
3.29034456231267	1	0.00556935551357355	0.00703284002007361	0.00744741383921277
4.1753189365604	1	0.00492535804979329	0.00333870913406136	0.00660492220390015
5.29831690628371	1	0.00421230510891081	0.00137737896833114	0.00582528287019688
6.72335753649934	1	0.00357706619543305	0.000491545771329582	0.00510745262696598
8.53167852417281	1	0.00310606158508498	0.000151212809204697	0.00445017086232553
10.8263673387405	1	0.00266483476429651	3.99902773325136e-05	0.00385201383034234
13.7382379588326	1	0.00219589162720955	9.07293409323372e-06	0.00331130256336085
17.4332882219999	1	0.00180787731149367	1.7629853460575e-06	0.00282592266518842
22.1221629107045	1	0.00152680546516292	2.9301074117231e-07	0.00239332515488374
28.0721620394118	1	0.00125970032879044	4.16092536737472e-08	0.00201066636020383
35.6224789026244	1	0.0009908018128609	5.04418791768677e-09	0.00167485778952095
45.2035365636024	1	0.000784180182504234	5.21648141403871e-10	0.00138254610776588
57.3615251044868	1	0.000637329814763541	4.59930007429561e-11	0.00113018584638514
72.7895384398315	1	0.000497870463263674	3.45555517294095e-12	0.000914166779217411
92.3670857187386	1	0.000366450810046645	2.21142924345693e-13	0.000730856356502383
117.210229753348	1	0.000272789162246809	1.20486124161029e-14	0.000576591020878909
148.735210729351	1	0.00020667168291135	5.58110111917574e-16	0.000447749015796929
188.73918221351	1	0.000141170315081723	1.9698003950032e-17	0.000340920957591891
239.502661998749	1	7.82797102055277e-05	NaN	0.000253101720393945
303.91953823132	1	3.47839435224389e-05	NaN	0.000181842350764282
385.662042116347	1	1.33260228281146e-05	NaN	0.000125283589903143
489.390091847749	1	4.85077772444996e-06	NaN	8.196957926272e-05
621.016941891562	1	1.70758590134431e-06	NaN	5.04686858666829e-05
788.046281566991	1	5.59741478587604e-07	NaN	2.90311554777918e-05
1000	1	1.66650626984303e-07	NaN	1.55302145376032e-05];
end
% data processing
s       = BM1(:,1);
BM1(:,2)=[];
BM2(:,2)=[];
BM3(:,2)=[];
BU1(:,2)=[];
BU2(:,2)=[];
BU3(:,2)=[];

%% Plotting
if 0
    close all
    f=figure;
    f.Position=[209   363   749   303];
    subplot(1,3,1)
    hold on
    loglog(s,BM1(:,2)              ,'color',[    0        0.447        0.741])
    loglog(s,BM1(:,3),'--'         ,'color',[    0        0.447        0.741])
    loglog(s,BM1(:,4),'linewidth',2,'color',[    0        0.447        0.741])    
    loglog(s,BU1(:,2),'color',[ 0.85        0.325        0.098])
    loglog(s,BU1(:,4),'color',[ 0.85        0.325        0.098],'linewidth',2)
    set(gca,'xscale','log','yscale','log','xlim',[1 1300],'ylim',[1e-5 1e0],'xtick',[1 10 100 1000],'ytick',10.^[-5:0])
    xlabel('Settlement (mm)'); ylabel('MRE')
    title('MR_1')
    
    subplot(1,3,2)
    hold on
    loglog(s,BM2(:,2)              ,'color',[    0        0.447        0.741])
    loglog(s,BM2(:,3),'--'         ,'color',[    0        0.447        0.741])
    loglog(s,BM2(:,4),'linewidth',2,'color',[    0        0.447        0.741])    
    loglog(s,BU2(:,2),'color',[ 0.85        0.325        0.098])
    loglog(s,BU2(:,4),'color',[ 0.85        0.325        0.098],'linewidth',2)
    set(gca,'xscale','log','yscale','log','xlim',[1 1300],'ylim',[1e-5 1e0],'xtick',[1 10 100 1000],'ytick',10.^[-5:0])
    xlabel('Settlement (mm)');
    title('MR_2')
    
    subplot(1,3,3)
    hold on
    loglog(s,BM3(:,2)              ,'color',[    0        0.447        0.741])
    loglog(s,BM3(:,3),'--'         ,'color',[    0        0.447        0.741])
    loglog(s,BM3(:,4),'linewidth',2,'color',[    0        0.447        0.741])    
    loglog(s,BU3(:,2),'color',[ 0.85        0.325        0.098])
    loglog(s,BU3(:,4),'color',[ 0.85        0.325        0.098],'linewidth',2)
    
    set(gca,'xscale','log','yscale','log','xlim',[1 1300],'ylim',[1e-5 1e0],'xtick',[1 10 100 1000],'ytick',10.^[-5:0])
    L=legend('Ds (BM2017)','Dv (BM2017)','LIBS (BM2017)','Ds (B2018)','LIBS (B2018)');
    L.Box='off'; L.Title.String='Settlement Component';L.Location='NorthEast';
    xlabel('Settlement (mm)');
    title('MR_3')
end

if 1
    close all
    f=figure;
    f.Position=[209   363   749   303];
    subplot(1,2,1)
    hold on
    loglog(s,BM1(:,2)              ,'color',[    0        0.447        0.741])
    loglog(s,BM1(:,3),'--'         ,'color',[    0        0.447        0.741])
    loglog(s,BM1(:,4),'linewidth',2,'color',[    0        0.447        0.741])    
    loglog(s,BU1(:,2),'color',[ 0.85        0.325        0.098])
    loglog(s,BU1(:,4),'color',[ 0.85        0.325        0.098],'linewidth',2)
    set(gca,'xscale','log','yscale','log','xlim',[1 1300],'ylim',[1e-5 1e0],'xtick',[1 10 100 1000],'ytick',10.^[-5:0])
    xlabel('Settlement (mm)'); ylabel('MRE')
    text(400,0.5,'MR1','fontweight','bold')
    
    L=legend('Ds (BM2017)','Dv (BM2017)','LIBS (BM2017)','Ds (B2018)','LIBS (B2018)');
    L.Box='off'; L.Title.String='Settlement Component';L.Location='SouthWest';    
    text(0.2,1,'(a)')
    
    subplot(1,2,2)
    hold on
    loglog(s,BM2(:,2)              ,'color',[    0        0.447        0.741])
    loglog(s,BM2(:,3),'--'         ,'color',[    0        0.447        0.741])
    loglog(s,BM2(:,4),'linewidth',2,'color',[    0        0.447        0.741])    
    loglog(s,BU2(:,2),'color',[ 0.85        0.325        0.098])
    loglog(s,BU2(:,4),'color',[ 0.85        0.325        0.098],'linewidth',2)
    set(gca,'xscale','log','yscale','log','xlim',[1 1300],'ylim',[1e-5 1e0],'xtick',[1 10 100 1000],'ytick',10.^[-5:0])
    xlabel('Settlement (mm)');
    text(400,0.5,'MR2','fontweight','bold')
    text(0.2,1,'(b)')
end

%% PSEUDO-PROBABILISTIC APPROACH FOR BRAY AND MACEDO
clc
param =loadsiteLIBS('CPTZ1B3.txt','');
param.Q=param.Q(1);

%        M   Rrup   CAV       CAVdp       PGA         SA1
% RetPeriod = 475;
% data1 = [6.4500	23.3000	0.6651	1.3992	0.4616	0.2592
% 6.2500	23.3000	0.4037	0.7336	0.2892	0.1820
% 6.2500	33.4000	0.2563	0.4090	0.1860	0.1260];

%
RetPeriod = 2475;
data1=[6.6500	28.1000	1.1225	2.7584	0.7322	0.4507
6.4500	23.3000	0.8011	1.7311	0.5206	0.2766
6.4500	23.3000	0.6108	1.1957	0.3934	0.2378];


M     = data1(:,1);
R     = data1(:,2);
CAV   = data1(:,3)*980.66;
CAVdp = data1(:,4)*980.66;
PGA   = data1(:,5);
SA1   = data1(:,6);

im3   = [CAVdp,PGA,SA1];
D     = zeros (3,14);


% column 1
for i=1:3
    D(i,1) =exp(pseudoProbaBMDs(param,im3(i,:),M(i),'BI14'))*0.5 +...
        exp(pseudoProbaBMDs(param,im3(i,:),M(i),'R15'))*0.5;
end

%column 2
for i=1:3
    D(i,2) = exp(libs_Juang2013Dv(param,PGA(i),M(i)));
end

%column 3
for i=1:3
    D(i,3) = libs_Hutabarat2020De(param,PGA(i),M(i),'BI14');
end

% column 4
for i=1:3
    D(i,4) = exp(pseudoProbaBM(param,im3(i,1),im3(i,2),im3(i,3),M(i),'BI14'))*0.5+...
        exp(pseudoProbaBM(param,im3(i,1),im3(i,2),im3(i,3),M(i),'R15')) *0.5+D(i,3);
end

% column 5
for i=1:3
    D(i,5) = exp(libs_Bullock2018Ds(param,CAV(i)));
end

% column 6
for i=1:3
    D(i,6) = D(i,5)*(exp(libs_Bullock2018Dv(param,CAV(i)))-1);
end

% column 7
for i=1:3
    D(i,7) = exp(libs_Bullock2018(param,CAV(i)));
end

% colum 8
D(1,8)= robustinterp(BM1(:,2),s,1/RetPeriod,'loglog');
D(2,8)= robustinterp(BM2(:,2),s,1/RetPeriod,'loglog');
D(3,8)= robustinterp(BM3(:,2),s,1/RetPeriod,'loglog');

% colum 9
D(1,9)= robustinterp(BM1(:,3),s,1/RetPeriod,'loglog');
D(2,9)= robustinterp(BM2(:,3),s,1/RetPeriod,'loglog');
D(3,9)= robustinterp(BM3(:,3),s,1/RetPeriod,'loglog');


% column 10
D(:,10)=D(:,3);

% colum 11  Ds + Dv +De
D(1,11)= robustinterp(BM1(:,4),s,1/RetPeriod,'loglog') + D(1,10);
D(2,11)= robustinterp(BM2(:,4),s,1/RetPeriod,'loglog') + D(2,10);
D(3,11)= robustinterp(BM3(:,4),s,1/RetPeriod,'loglog') + D(3,10);

% colum 12
D(1,12)= robustinterp(BU1(:,2),s,1/RetPeriod,'loglog');
D(2,12)= robustinterp(BU2(:,2),s,1/RetPeriod,'loglog');
D(3,12)= robustinterp(BU3(:,2),s,1/RetPeriod,'loglog');


% colum 13
D(1,13)= robustinterp(BU1(:,3),s,1/RetPeriod,'loglog');
D(2,13)= robustinterp(BU2(:,3),s,1/RetPeriod,'loglog');
D(3,13)= robustinterp(BU3(:,3),s,1/RetPeriod,'loglog');

% colum 14
D(1,14)= robustinterp(BU1(:,4),s,1/RetPeriod,'loglog');
D(2,14)= robustinterp(BU2(:,4),s,1/RetPeriod,'loglog');
D(3,14)= robustinterp(BU3(:,4),s,1/RetPeriod,'loglog');



