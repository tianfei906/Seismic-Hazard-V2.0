%%
clearvars
close all
clc
subplot(2,2,1);
b     = 0.7;
Mmin  = 4.0;
Mmax  = 7.5;
beta  = log(10)*b;
M     = 7;
rateM = 1/200;
ccdf  = (1-exp(-beta*(M-Mmin)))/(1-exp(-beta*(Mmax - Mmin)));
NMmin = rateM/(1-ccdf);
m     = linspace(4,7.5,100);
ccdf  = (1-exp(-beta*(m-Mmin)))/(1-exp(-beta*(Mmax - Mmin)));
rate  = NMmin*(1-ccdf);
plot(m,rate)

b     = 0.6;
Mmin  = 4.0;
Mmax  = 7.5;
beta  = log(10)*b;
M     = 7;
rateM = 1/600;
ccdf  = (1-exp(-beta*(M-Mmin)))/(1-exp(-beta*(Mmax - Mmin)));
NMmin = rateM/(1-ccdf);
m     = linspace(4,7.5,100);
ccdf  = (1-exp(-beta*(m-Mmin)))/(1-exp(-beta*(Mmax - Mmin)));
rate  = NMmin*(1-ccdf);
hold on
plot(m,rate)

box off
set(gca,'yscale','log')
xlabel('Magnitude')
ylabel('Magnitude rate')
L=legend('MR1','MR2');
L.Box='off';
L.Title.String='Scenario';
set(gca,'ytick',10.^[-4:1:0]);
text(3,1,'(a)')

%%
clearvars

PGA=[0.0001	1.13179686041641
0.000162377673918872	1.12658353576847
0.000263665089873036	1.11186467667408
0.00042813323987194	1.07902177815132
0.000695192796177561	1.01966774908331
0.00112883789168469	0.930172529421189
0.00183298071083244	0.813784193165062
0.00297635144163132	0.67918076770755
0.00483293023857175	0.537871566725832
0.00784759970351461	0.401874231976974
0.0127427498570313	0.2816412246929
0.0206913808111479	0.184188285672949
0.0335981828628378	0.111661333434057
0.0545559478116852	0.0619601618134373
0.0885866790410082	0.0309236580013209
0.143844988828766	0.0135801981206273
0.233572146909012	0.00497988474937453
0.379269019073225	0.00137023493445262
0.615848211066026	0.000248869874658036
1	2.6937785966433e-05];

SA1=[1e-05	1.13358060709645
1.83298071083244e-05	1.13355606775453
3.35981828628378e-05	1.1332021816743
6.15848211066027e-05	1.13026571582175
0.000112883789168469	1.11572289240589
0.000206913808111479	1.07058167077862
0.000379269019073225	0.976707610059546
0.000695192796177561	0.83438502732228
0.00127427498570313	0.663760705188086
0.00233572146909012	0.493354320623778
0.0042813323987194	0.347026382518768
0.00784759970351461	0.234706255733197
0.0143844988828766	0.152822859533158
0.0263665089873036	0.0938309233445875
0.0483293023857175	0.0525653171420983
0.0885866790410082	0.0257876740385061
0.162377673918872	0.0105652011143121
0.297635144163132	0.0033717528363812
0.545559478116851	0.000754904158295063
1	0.000106198902756559];

CAVdp=[0.1	1.13358114343517
0.172043377848618	1.13357371264488
0.295989238615622	1.13348484699952
0.50922988418272	1.13275947558487
0.876096293762555	1.12867051298897
1.50726565699565	1.11249975892526
2.59315074944747	1.06667771168445
4.46134414205616	0.971065130235327
7.67544715944484	0.819288068146106
13.2050985580947	0.629696315225052
22.7184976075852	0.437748615923898
39.0856706805469	0.276384214333184
67.2443080935996	0.160857567479894
115.68937905516	0.087965639738746
199.035915538588	0.0456993019283195
342.428112224509	0.0223687372587216
589.124890974299	0.00999684361538954
1013.55036217917	0.00387673205919277
1743.74627928994	0.00122798171468802
3000	0.000299806056552608];

CAV=[
0.01	1.13358158015704
0.0158214613571711	1.13358158015691
0.0250318639476458	1.13358158014142
0.0396040668145641	1.13358157905968
0.0626594212693448	1.13358153215639
0.0991363612275642	1.13358026015223
0.156848210825246	1.13355846249646
0.248156790651305	1.13331932624044
0.392620307380922	1.13161134184485
0.621182702126789	1.12349379450673
0.98280181174421	1.09706014854306
1.55493608862687	1.03573315699981
2.46013612390808	0.929272452367649
3.89229486177924	0.783394977427577
6.15817927463558	0.617789170250028
9.74313954241786	0.456482721048279
15.415070576789	0.318237346961229
24.3888943448732	0.210586532834377
38.5867949421539	0.132223728584995
61.0499485074372	0.0786404822209922
96.5899401167702	0.0444042077227249
152.819400504895	0.0238262118089354
241.782623971424	0.0118545295733458
382.535444199932	0.00508792048967636
605.226974815749	0.00167479699535302
957.557519436493	0.000368942654370674
1514.99592910331	4.77571912364422e-05
2396.94495485795	3.272440355595e-06
3792.31719785512	1.1059110716428e-07
6000	1.76509654266392e-09];




ax(1)=subplot(2,2,2);
hold on
plot(PGA(:,1),PGA(:,2))
plot(SA1(:,1),SA1(:,2))
set(gca,'xscale','log','yscale','log','xtick',10.^[-3:1:0],'xlim',[1e-3 1],'ylim',[1e-5 1e1],'fontsize',9)
L=legend('PGA','SA1');L.Box='off';
xlabel('PGA, SA1 (g)')
ylabel('MRE')
text(2e-4,10,'(b)')

ax(2)=subplot(2,2,3);
hold on
plot(CAVdp(:,1)/980.66,CAVdp(:,2)); %CAV   500 m/s
plot(CAV  (:,1)/980.66,CAV  (:,2)); %CAVdp 760 m/s
set(gca,'xscale','log','yscale','log','xtick',10.^[-3:1:0],'xlim',[1e-3 4],'ylim',[1e-5 1e1],'fontsize',9)
L=legend('CAVdp','CAV');L.Box='off';
xlabel('CAVdp,CAV (g\cdots)')
ylabel('MRE')
text(2e-4,10,'(c)')

set(gcf,'position',[   403   122   642   544])
